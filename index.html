<!doctype html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Waukesha County Housing Market Statistics</title>

  <!-- SEO / Social (single source of truth) -->
  <link rel="canonical" href="https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats" />
  <meta name="robots" content="index,follow" />
  <meta name="description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />

  <meta property="og:site_name" content="Josh Werner — Realty ONE Group Luminous" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:title" content="Waukesha County Housing Market Statistics" />
  <meta property="og:description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats" />
  <meta property="og:image" content="https://waukesha-market-stats.vercel.app/og-image.png" />
  <meta property="og:image:alt" content="Waukesha County Market Statistics — Live, auto-updated" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Waukesha County Housing Market Statistics" />
  <meta name="twitter:description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />
  <meta name="twitter:image" content="https://waukesha-market-stats.vercel.app/og-image.png" />

  <meta name="theme-color" content="#C5A349" />
  <meta name="google-site-verification" content="_PjSWN6opbxekpcvJNTYO1gk8nnVpJPm6VE6AYSTbDc" />
  <meta name="msvalidate.01" content="51198E56FE8D9E5EE8E0A011FF64E88D" />

  <!-- Screen styles -->
  <style>
    :root {
      --brand:#C5A349; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f9; --card:#fff;
      --radius:16px; --shadow:0 10px 24px rgba(0,0,0,.08); --shadow-sm:0 3px 10px rgba(0,0,0,.06);
      --maxw:1100px;
    }
    html, body { height:100%; }
    body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; color:var(--ink); background:var(--bg); }
    .container { max-width:var(--maxw); margin-inline:auto; padding:24px; }
    .hero { background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px 18px; }
    .title { margin:0; font-size:clamp(22px,3vw,34px); font-weight:800; }
    .subtitle { margin:4px 0 0 0; color:var(--muted); font-size:14px; }
    .controls { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .pill { display:flex; gap:10px; padding:8px 12px; border-radius:999px; background:#fff; border:1px solid #e5e7eb; box-shadow:var(--shadow-sm); }
    .select, .button { border:1px solid #e5e7eb; background:#fff; border-radius:12px; padding:10px 12px; font-size:14px; }
    .button { cursor:pointer; }

    .subnav { position:sticky; top:0; z-index:1000; display:flex; gap:14px; margin-top:8px; font-size:14px;
      background:var(--card); padding:10px 0; border-top:1px solid #eee; border-bottom:1px solid #eee; box-shadow:0 2px 10px rgba(0,0,0,.04); }
    .subnav a { color:var(--muted); } .subnav a:hover { color:var(--ink); }
    .grid-2 { display:grid; grid-template-columns:1fr; gap:16px; margin-top:16px; }
    @media (min-width:900px) { .grid-2 { grid-template-columns:1fr 1fr; } }
    .card { background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px 18px; }
    .kpis { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px; }
    @media (min-width:720px) { .kpis { grid-template-columns:repeat(3,1fr); } }
    .kpi { border:1px solid #eef0f3; border-radius:14px; padding:12px; background:#fff; }
    .kpi .label { font-size:12px; color:var(--muted); text-transform:uppercase; }
    .kpi .value { font-size:clamp(22px,3vw,28px); font-weight:800; margin-top:6px; }
    .kpi .delta { font-size:12px; margin-top:4px; }
    .up { color:#15803d; } .down { color:#b91c1c; }

    .community-card { display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border:1px solid #eef0f3; border-radius:12px; background:#fff; box-shadow:var(--shadow-sm); }
    .community-grid { display:grid; grid-template-columns:1fr; gap:12px; }
    @media (min-width:680px) { .community-grid { grid-template-columns:repeat(2,1fr); } }
    @media (min-width:980px) { .community-grid { grid-template-columns:repeat(3,1fr); } }

    .search { display:flex; gap:10px; align-items:center; padding:10px 12px; border-radius:12px; background:#fff; border:1px solid #e5e7eb; box-shadow:var(--shadow-sm); }
    .search input { border:none; outline:none; flex:1; font-size:14px; }
    a.link { color:var(--ink); text-decoration:none; border-bottom:1px solid #ddd; }

    .foot { display:flex; align-items:center; justify-content:space-between; gap:12px; color:var(--muted); font-size:12px; margin-top:14px; }
    html { scroll-behavior:smooth; }
    #sf, #condo, #communities { scroll-margin-top:80px; }

    .skel { background:#eef0f3; border-radius:10px; height:32px; animation:pulse 1.2s ease-in-out infinite; }
    @keyframes pulse { 0%{opacity:.6} 50%{opacity:1} 100%{opacity:.6} }
    .muted { color:var(--muted); }

    .embed header.container, .embed footer.container { display:none; }
    .embed .container { padding-top:12px; }

    :root{ --brand-50:#f8f3e6; --brand-100:#f1e6c9; --brand-200:#e7d5a1; --brand-600:#a8842d; --brand-700:#8f6f25; --bg:#fbfaf7; }
    body { background:var(--bg); }

    .cta { margin-top:16px; background:linear-gradient(180deg,#fff,#fbfaf7); border:1px solid #e9e5d6; border-radius:14px; padding:18px; box-shadow:0 6px 18px rgba(0,0,0,.06); }
    .cta h3 { margin:0 0 6px 0; font-size:18px; }
    .cta p { margin:0 0 12px 0; color:var(--muted); font-size:14px; }
    .cta-actions { display:flex; gap:10px; flex-wrap:wrap; }
    .btn, .btn-ghost { display:inline-block; padding:10px 14px; border-radius:10px; font-size:14px; text-decoration:none; border:1px solid var(--brand-200); }
    .btn { background:var(--brand); color:#fff; border-color:var(--brand-600); box-shadow:var(--shadow-sm); }
    .btn:hover { filter:brightness(0.95); }
    .btn-ghost { background:#fff; color:var(--ink); }
    .btn-ghost:hover { background:#f8f5ec; }
    @media print { .cta { display:none !important; } }

    .button{ background:var(--brand); color:#fff; border-color:var(--brand-600); box-shadow:var(--shadow-sm); }
    .button:hover{ filter:brightness(0.95); }
    .pill{ background:var(--brand-50); border-color:var(--brand-200); }
    .badge{ background:var(--brand-50); border:1px solid var(--brand-200); color:var(--brand-700); padding:4px 8px; border-radius:999px; font-size:12px; }

    .hero{
      background:
        radial-gradient(600px 220px at 85% -10%, rgba(197,163,73,.18), transparent 70%),
        radial-gradient(520px 180px at -10% 110%, rgba(197,163,73,.12), transparent 70%),
        var(--card);
    }
    .card{ position:relative; transition:box-shadow .2s ease, transform .2s ease; }
    @media(hover:hover){ .card:hover{ box-shadow:0 12px 26px rgba(0,0,0,.10); transform:translateY(-1px); } }
    .card::before{ content:""; position:absolute; top:0; left:0; right:0; height:3px; border-radius:var(--radius) var(--radius) 0 0;
      background:linear-gradient(90deg, var(--brand), rgba(197,163,73,0) 65%); pointer-events:none; }
    .kpi .value{ color:var(--ink); font-variant-numeric:tabular-nums; letter-spacing:-.2px; text-shadow:0 1px 0 rgba(255,255,255,.55); }
    @supports (-webkit-background-clip:text){
      .kpi .value{
        background:linear-gradient(180deg, var(--ink) 0%, rgba(31,41,55,.90) 55%, rgba(31,41,55,.76) 100%);
        -webkit-background-clip:text; -webkit-text-fill-color:transparent; text-shadow:none;
      }
    }
    .card h2{ position:relative; padding-bottom:6px; }
    .card h2::after{ content:""; position:absolute; left:0; bottom:0; width:42px; height:3px;
      background:linear-gradient(90deg, var(--brand), rgba(197,163,73,0)); border-radius:2px; pointer-events:none; }
    @media print{ .card h2::after{ display:none; } }

    :root{ --focus-outline:#e7d5a1; --focus-ring:rgba(197,163,73,.35); }
    :where(.button, .select, .search input, .community-card, a.link){ outline:none; }
    :where(.button, .select, .search input, .community-card, a.link):focus-visible{
      outline:2px solid var(--focus-outline); outline-offset:2px; box-shadow:0 0 0 4px var(--focus-ring); border-radius:10px;
    }
    @media print{ :where(.button, .select, .search input, .community-card, a.link):focus-visible{ outline:none !important; box-shadow:none !important; } }

    .embed .container{ padding:16px; }
    @media (min-width:900px){ .embed .container{ padding:20px; } }
    .embed .hero{ padding:12px 14px; }
    .embed .subnav{ margin-top:6px; }
    .embed .foot{ margin-top:10px; }

    .community-card{ transition:box-shadow .15s ease, transform .15s ease, border-color .15s ease, background .15s ease; }
    .community-card span:last-child{ color:#9ca3af !important; transition:transform .15s ease, color .15s ease; }
    @media(hover:hover){
      .community-card:hover{ background:#fff; border-color:#e6e0cf; box-shadow:0 8px 18px rgba(0,0,0,.08); transform:translateY(-1px); }
      .community-card:hover span:last-child{ color:var(--brand-700) !important; transform:translateX(2px); }
    }
    .community-card:focus-visible{ outline:2px solid var(--brand-200); outline-offset:2px; }

    /* Print styles */
    @page { size: Letter portrait; margin: 0.5in; }
    @media print {
      html, body { background:#fff !important; color:#111 !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .container { max-width:none !important; padding:0 !important; }
      header.container, main.container, footer.container { padding:0 !important; }
      .hero { margin:0 0 0.25in 0 !important; box-shadow:none !important; border:none !important; border-radius:0 !important; }
      .subnav, .search, #printBtn { display:none !important; }
      .grid-2 { grid-template-columns:1fr 1fr !important; gap:0.35in !important; }
      .card { box-shadow:none !important; border:1px solid #e5e7eb !important; border-radius:8px !important; }
      .kpi { break-inside:avoid; }
      .foot { color:#6b7280 !important; }
      .title { font-size:22px !important; }
      .subtitle { font-size:12px !important; }
      .kpi .label { font-size:11px !important; }
      .kpi .value { font-size:20px !important; }
      a.link { color:#111 !important; border-bottom:1px solid #ddd !important; text-decoration:none !important; }
      .container > * { margin-left:0.25in; margin-right:0.25in; }
      .hero, .grid-2, #communities, footer.container { margin-left:0.25in; margin-right:0.25in; }
      #communities { display:none !important; }
      #communities, #communities.card { page-break-before:auto !important; break-before:auto !important; }
    }

    /* Print-only brand header */
    .print-brand { display:none; }
    @media print {
      .print-brand { display:flex !important; align-items:center; gap:14px; margin:0 0 0.25in 0; padding-bottom:10px; border-bottom:1px solid #e5e7eb; }
      .print-logo { height:56px; max-width:260px; object-fit:contain; }
      .print-contact { font-size:12px; line-height:1.35; }
      .print-contact strong { font-size:14px; }
      .print-contact a { color:#111 !important; text-decoration:none; border-bottom:1px solid #ddd; }
      .print-updated { margin-top:2px; font-size:11px; color:#6b7280; }
    }

    /* FAQ */
    #faq .faq-item{ border:1px solid #e9e5d6; border-radius:12px; background:#fff; margin-top:8px; overflow:hidden; }
    #faq summary{ cursor:pointer; padding:12px 14px; list-style:none; font-weight:600; display:flex; align-items:center; justify-content:space-between; }
    #faq summary::-webkit-details-marker{ display:none; }
    #faq summary::after{ content:"▸"; margin-left:10px; transition:transform .15s ease; color:var(--brand-700); }
    #faq .faq-item[open] summary::after{ transform:rotate(90deg); }
    #faq .answer{ padding:0 14px 14px; color:var(--muted); }
    @media print{ #faq{ display:none !important; } }
  </style>

  <!-- JSON-LD (these dates will be synced by JS) -->
  <script id="ld-dataset" type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Dataset",
    "@id":"https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats#dataset",
    "name":"Waukesha County Housing Market Statistics",
    "description":"Monthly market stats for Waukesha County, WI (Single-Family & Condo): Median Price, Closed Sales, Days on Market, and Months Supply. Auto-updated from RPR.",
    "creator":{"@type":"Person","name":"Josh Werner"},
    "publisher":{"@type":"Organization","name":"Realty ONE Group Luminous"},
    "isAccessibleForFree": true,
    "keywords":["Waukesha County","real estate","market statistics","Wisconsin"],
    "license":"https://www.narrpr.com/terms/",
    "distribution":[
      {"@type":"DataDownload","encodingFormat":"application/pdf","contentUrl":"https://www.narrpr.com/reports-v2/c296fac6-035d-4e9a-84fd-28455ab0339f/pdf"},
      {"@type":"DataDownload","encodingFormat":"application/pdf","contentUrl":"https://www.narrpr.com/reports-v2/5a675486-5c7b-4bb0-9946-0cffa3070f05/pdf"}
    ],
    "dateModified":"2025-09-16"
  }
  </script>

  <script id="ld-webpage" type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Waukesha County Housing Market Statistics",
    "url":"https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats",
    "inLanguage":"en-US",
    "description":"Waukesha County housing market statistics updated daily: median price, closed sales, days on market, and months of supply for single-family homes and condos.",
    "isPartOf":{"@type":"WebSite","name":"Josh Werner Real Estate","url":"https://joshwerner.homes"},
    "primaryImageOfPage":{"@type":"ImageObject","url":"https://waukesha-market-stats.vercel.app/og-image.png"}
  }
  </script>

  <script id="ld-faq" type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {"@type": "Question","name": "How often are these stats updated?","acceptedAnswer": {"@type": "Answer","text": "County stats refresh automatically within ~48 hours of RPR updating the underlying PDFs. Community links open live RPR reports that always show the latest version."}},
      {"@type": "Question","name": "What property types are included?","acceptedAnswer": {"@type": "Answer","text": "We publish snapshots for Single-Family homes and Condos/Townhomes. Each panel shows Median Price, Closed Sales, Days on Market, and Months of Supply."}},
      {"@type": "Question","name": "Where do these numbers come from?","acceptedAnswer": {"@type": "Answer","text": "Realtors Property Resource® (RPR). The county panels summarize key figures extracted from the Waukesha County RPR PDF; community links point to each city’s live RPR report."}},
      {"@type": "Question","name": "Can I get a custom city or neighborhood report?","acceptedAnswer": {"@type": "Answer","text": "Yes—contact Josh and we’ll generate a tailored RPR report with recent comps and trends."}}
    ]
  }
  </script>

  <!-- Meta dates; JS updates these -->
  <meta id="meta-lastmod" name="last-modified" content="2025-09-16" />
  <meta id="og-updated" property="og:updated_time" content="2025-09-16T12:00:00Z" />
</head>
<body>
  <header class="container">
    <!-- Print-only brand header -->
    <div class="print-brand" aria-hidden="true">
      <img class="print-logo" src="/logo.png" alt="Realty ONE Group Luminous — Josh Werner" />
      <div class="print-contact">
        <strong>Josh Werner</strong><br />
        Licensed REALTOR® — Realty ONE Group Luminous<br />
        <a href="tel:+14147597925">(414) 759-7925</a> ·
        <a href="mailto:joshwernerrealtor@gmail.com?subject=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!">Email</a> ·
        <a href="https://joshwerner.homes" target="_blank" rel="noopener">joshwerner.homes</a><br />
        WI License #: 93792-94
        <div class="print-updated" id="printUpdated"></div>
      </div>
    </div>

    <!-- Hero -->
    <section class="hero">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h1 class="title">Waukesha County Housing Market Statistics</h1>
          <p class="subtitle">Side by side snapshots for Single-Family and Condos. Updated automatically from RPR.</p>
        </div>
        <div class="controls">
          <span class="pill"><span>Updated</span><strong id="updatedAt">—</strong></span>
          <label class="pill"><span>Month</span><select id="monthSelect" class="select"></select></label>
          <button id="printBtn" class="button" type="button">Print / PDF</button>
        </div>
      </div>
      <nav class="subnav" aria-label="Section navigation">
  <a href="#sf">Single-Family</a>
  <a href="#condo">Condos</a>
  <a href="#communities">Communities</a>
</nav>
    </section>
  </header>

  <main class="container">
    <!-- Rates section REMOVED -->

    <section class="grid-2">
      <article id="sf" class="card" aria-labelledby="sfTitle">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
          <h2 id="sfTitle" style="margin:0;font-size:20px">Single-Family Homes</h2>
          <span class="badge" id="sfMonth">—</span>
        </div>
        <div class="kpis" id="sfKpis"></div>
        <div class="foot">
          <span id="sfNote"></span>
          <a id="sfReport" class="link" href="https://www.narrpr.com/reports-v2/c296fac6-035d-4e9a-84fd-28455ab0339f/pdf" target="_blank" rel="noopener">Full county report</a>
        </div>
      </article>

      <article id="condo" class="card" aria-labelledby="condoTitle">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
          <h2 id="condoTitle" style="margin:0;font-size:20px">Condos / Townhomes</h2>
          <span class="badge" id="condoMonth">—</span>
        </div>
        <div class="kpis" id="condoKpis"></div>
        <div class="foot">
          <span id="condoNote"></span>
          <a id="condoReport" class="link" href="https://www.narrpr.com/reports-v2/5a675486-5c7b-4bb0-9946-0cffa3070f05/pdf" target="_blank" rel="noopener">Full county report</a>
        </div>
      </article>
    </section>

    <section id="communities" class="card" style="margin-top:16px">
      <div style="display:flex;align-items:end;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h3 style="margin:0;font-size:18px">Top 10 Communities</h3>
          <p class="subtitle" style="margin:6px 0 0 0">These RPR® reports update automatically every ~48 hours. Click a community to view the live PDF.</p>
        </div>
        <div class="search" role="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="7" stroke="#9ca3af" stroke-width="2"/><path d="M20 20l-3.2-3.2" stroke="#9ca3af" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="searchInput" type="search" placeholder="Search communities…" aria-label="Search communities" />
        </div>
      </div>
      <div id="communityGrid" class="community-grid" style="margin-top:12px"></div>
    </section>

    <section id="faq" class="card" style="margin-top:16px">
      <h2 style="margin:0 0 8px 0; font-size:18px">Market FAQs</h2>

      <details class="faq-item" open>
        <summary>How often are these Waukesha County stats updated?</summary>
        <div class="answer">
          This page checks for new data every day around 6:00 AM Central (11:00 UTC). Figures refresh shortly after
          RPR regenerates its county Market Trends reports (typically every ~48 hours). The “Updated” date shows the
          last successful pull.
        </div>
      </details>

      <details class="faq-item">
        <summary>Where do these numbers come from?</summary>
        <div class="answer">
          Realtors Property Resource® (RPR) county Market Trends PDFs. Links to the full reports are provided on this page.
        </div>
      </details>

      <details class="faq-item">
        <summary>Which metrics are shown?</summary>
        <div class="answer">
          Median Sold Price, Closed Sales, Median Days in RPR (Days on Market), Months of Inventory, and Active Listings (when available).
        </div>
      </details>

      <details class="faq-item">
        <summary>Does this include both single-family and condos?</summary>
        <div class="answer">
          Yes—two side-by-side snapshots. Each links to the corresponding county PDF report for deeper detail.
        </div>
      </details>

      <details class="faq-item">
        <summary>Can I print this as a one-page handout?</summary>
        <div class="answer">
          Yes—use the “Print / PDF” button. The Communities section is hidden on paper to keep the printout to one page.
        </div>
      </details>

      <details class="faq-item">
        <summary>How can I get stats for my neighborhood or a custom report?</summary>
        <div class="answer">
          Use the community links above or contact Josh at (414) 759-7925 or joshwernerrealtor@gmail.com for a custom report.
        </div>
      </details>
    </section>

    <section id="related" class="card" style="margin-top:16px">
      <h2 style="margin:0 0 8px 0; font-size:18px">Explore Waukesha Communities</h2>
      <p class="subtitle" style="margin:6px 0 10px 0">Local market guides and homes for sale by city.</p>
      <ul class="related-grid" style="list-style:none; padding:0; margin:0; display:grid; gap:10px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
      <li><a class="link" href="/mukwonago-real-estate-market.html">Mukwonago Market Guide</a></li>
        <li><a class="link" href="#">Brookfield Market Guide</a></li>
        <li><a class="link" href="#">Menomonee Falls Market Guide</a></li>
        <li><a class="link" href="#">New Berlin Market Guide</a></li>
        <li><a class="link" href="#">Muskego Market Guide</a></li>
        <li><a class="link" href="#">Pewaukee Market Guide</a></li>
        <li><a class="link" href="#">Oconomowoc Market Guide</a></li>
        <li><a class="link" href="#">Hartland Market Guide</a></li>
        <li><a class="link" href="#">Delafield Market Guide</a></li>
        <li><a class="link" href="#">Sussex Market Guide</a></li>
      </ul>
    </section>

    <!-- CTA block -->
    <section class="cta" aria-labelledby="ctaTitle">
      <h3 id="ctaTitle">Want a custom city or neighborhood report?</h3>
      <p>I’ll send you a fresh, tailored RPR® report with comps and trends—usually same day.</p>
      <div class="cta-actions">
        <a class="btn" href="mailto:joshwernerrealtor@gmail.com?subject=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!">Email Josh</a>
        <a class="btn outline" href="https://mail.google.com/mail/?view=cm&fs=1&to=joshwernerrealtor@gmail.com&su=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!" target="_blank" rel="noopener">Use Gmail</a>
        <a class="btn-ghost" href="tel:+14147597925" rel="noopener">Call (414) 759-7925</a>
        <a class="btn-ghost" href="https://joshwerner.homes/?utm_source=market-stats&utm_medium=cta&utm_campaign=waukesha" target="_blank" rel="noopener">Visit Website</a>
      </div>
    </section>
  </main>

  <footer class="container" style="opacity:.9;padding-top:0">
    <p style="font-size:12px;color:var(--muted)">Source: Realtors Property Resource® (RPR). County stats auto-refresh from the county PDF via a secure API.</p>
  </footer>

  <!-- Single, clean script: fetch data, sync dates/SEO, render KPIs + communities, print behavior -->
  <script>
    (function () {
      const ENDPOINT = "/api/waukesha";

      // Elements
      const $ = (q, el = document) => el.querySelector(q);
      const updatedAtEl = $("#updatedAt");
      const monthSelect = $("#monthSelect");
      const sfMonthEl = $("#sfMonth");
      const condoMonthEl = $("#condoMonth");
      const sfKpis = $("#sfKpis");
      const condoKpis = $("#condoKpis");
      const sfReport = $("#sfReport");
      const condoReport = $("#condoReport");
      const printUpdated = $("#printUpdated");
      const printBtn = $("#printBtn");
      const searchInput = $("#searchInput");
      const communityGrid = $("#communityGrid");

      const COMMUNITIES = [
        { name: "Brookfield", url: "https://www.narrpr.com/reports-v2/97a381b7-10f7-40e6-9e36-852d9a194cdf/pdf" },
        { name: "Menomonee Falls", url: "https://www.narrpr.com/reports-v2/e88b179b-2c39-4b51-9968-f4d8b6df89cb/pdf" },
        { name: "New Berlin", url: "https://www.narrpr.com/reports-v2/0eedbe20-e01d-4e10-8791-79e0e18f6853/pdf" },
        { name: "Muskego", url: "https://www.narrpr.com/reports-v2/adda4cc2-f31f-4549-a499-793c061484b8/pdf" },
        { name: "Pewaukee", url: "https://www.narrpr.com/reports-v2/d62c13ba-f21d-44d4-b4f1-cb89d62cfd1d/pdf" },
        { name: "Oconomowoc", url: "https://www.narrpr.com/reports-v2/2635ef10-f399-4498-987f-34784fca249a/pdf" },
        { name: "Hartland", url: "https://www.narrpr.com/reports-v2/579c97c4-b4d9-4eb4-980e-890348286b9b/pdf" },
        { name: "Delafield", url: "https://www.narrpr.com/reports-v2/cfaf9afb-4e22-44b9-b114-0d64b1be0639/pdf" },
        { name: "Mukwonago", url: "https://www.narrpr.com/reports-v2/17d2ea0c-a2d7-4dce-954c-e2140ac59f88/pdf" },
        { name: "Sussex", url: "https://www.narrpr.com/reports-v2/41f387a4-b092-42c4-b23a-b3575ae52116/pdf" }
      ];

      // Formatters
      const fCurrency = v => new Intl.NumberFormat("en-US", { style: "currency", currency: "USD", maximumFractionDigits: 0 }).format(v);
      const fNumber = v => new Intl.NumberFormat("en-US").format(v);
      const fNumber1 = v => new Intl.NumberFormat("en-US", { maximumFractionDigits: 1 }).format(v);

      function kpiEl(label, value, prev, type) {
        const el = document.createElement("div");
        el.className = "kpi";
        const ok = typeof value === "number" && !Number.isNaN(value);
        const havePrev = typeof prev === "number" && !Number.isNaN(prev);

        let txt = "—";
        if (ok) {
          txt = type === "currency" ? fCurrency(value)
            : type === "number1" ? fNumber1(value)
            : fNumber(value);
        }

        let delta = "";
        if (ok && havePrev) {
          const diff = value - prev;
          const dir = diff === 0 ? 0 : (diff > 0 ? 1 : -1);
          const pct = prev === 0 ? 0 : (diff / prev) * 100;
          const arrow = dir === 0 ? "—" : (dir > 0 ? "▲" : "▼");
          const cls = dir === 0 ? "" : (dir > 0 ? "up" : "down");
          delta = `<div class="delta ${cls}">${arrow} ${Math.abs(pct).toFixed(1)}% MoM</div>`;
        }

        el.innerHTML = `<div class="label">${label}</div><div class="value">${txt}</div>${delta}`;
        return el;
      }

      function paintMonth(key, payload) {
        if (!payload?.months) return;
        const months = Object.keys(payload.months).sort();
        const idx = months.indexOf(key);
        const cur = payload.months[key];
        const prev = payload.months[months[idx - 1]];
        const [y, m] = key.split("-");
        const label = new Date(+y, +m - 1, 1).toLocaleDateString(undefined, { month: "long", year: "numeric" });

        if (sfMonthEl) sfMonthEl.textContent = label;
        if (condoMonthEl) condoMonthEl.textContent = label;
        if (sfKpis) sfKpis.innerHTML = "";
        if (condoKpis) condoKpis.innerHTML = "";

        const METRICS = [
          { key: "medianPrice", label: "Median Price", type: "currency" },
          { key: "closed", label: "Closed Sales", type: "number" },
          { key: "dom", label: "Days on Market", type: "number" },
          { key: "monthsSupply", label: "Months Supply", type: "number1" },
          { key: "activeListings", label: "Active Listings", type: "number" }
        ];

        for (const mdef of METRICS) {
          if (sfKpis) sfKpis.appendChild(kpiEl(mdef.label, cur.sf?.[mdef.key], prev?.sf?.[mdef.key], mdef.type));
          if (condoKpis) condoKpis.appendChild(kpiEl(mdef.label, cur.condo?.[mdef.key], prev?.condo?.[mdef.key], mdef.type));
        }

        if (sfReport && cur?.sfReport) sfReport.href = cur.sfReport;
        if (condoReport && cur?.condoReport) condoReport.href = cur.condoReport;

        if (printUpdated && payload?.updatedAt) {
          try { printUpdated.textContent = "Updated " + new Date(payload.updatedAt).toLocaleDateString(); } catch {}
        }
      }

      function buildMonthDropdown(payload) {
        if (!monthSelect || !payload?.months) return;
        const months = Object.keys(payload.months).sort().reverse();
        monthSelect.innerHTML = "";
        for (const k of months) {
          const [y, m] = k.split("-");
          const dt = new Date(+y, +m - 1, 1);
          const opt = document.createElement("option");
          opt.value = k;
          opt.textContent = dt.toLocaleDateString(undefined, { month: "long", year: "numeric" });
          monthSelect.appendChild(opt);
        }
        monthSelect.value = months[0];
        monthSelect.onchange = e => paintMonth(e.target.value, payload);
        paintMonth(months[0], payload);
      }

      function renderCommunities(list) {
        if (!communityGrid) return;
        communityGrid.innerHTML = "";
        if (!Array.isArray(list) || !list.length) {
          const p = document.createElement("p");
          p.className = "muted";
          p.textContent = "No matching communities.";
          communityGrid.appendChild(p);
          return;
        }
        for (const c of list) {
          const a = document.createElement("a");
          a.className = "community-card";
          a.href = c.url;
          a.target = "_blank";
          a.rel = "noopener";
          a.setAttribute("aria-label", c.name + " market report PDF");
          a.innerHTML = `<span>${c.name}</span><span style="color:#9ca3af">PDF →</span>`;
          communityGrid.appendChild(a);
        }
      }

      function wireCommunitySearch() {
        if (!searchInput) return;
        renderCommunities(COMMUNITIES);
        searchInput.addEventListener("input", () => {
          const q = searchInput.value.trim().toLowerCase();
          if (!q) return renderCommunities(COMMUNITIES);
          const filtered = COMMUNITIES.filter(c => c.name.toLowerCase().includes(q));
          renderCommunities(filtered);
        });
      }

      async function loadWaukesha() {
        const r = await fetch(ENDPOINT + "?ts=" + Date.now(), { cache: "no-store" });
        if (!r.ok) throw new Error("API " + r.status + " " + r.statusText);
        return r.json();
      }
      async function loadUpdatedAt() {
        const r = await fetch("/api/updated-at?ts=" + Date.now(), { cache: "no-store" });
        if (!r.ok) throw new Error("API /api/updated-at failed " + r.status);
        return r.json();
      }
      function applyUpdatedAt(updated) {
        const d = updated?.updatedAt;
        if (!d) return;
        if (updatedAtEl) {
          try { updatedAtEl.textContent = new Date(d + "T12:00:00Z").toLocaleDateString(); } catch {}
        }
        $("#meta-lastmod")?.setAttribute("content", d);
        $("#og-updated")?.setAttribute("content", d + "T12:00:00Z");
        const ds = $("#ld-dataset");
        if (ds) { try { const data = JSON.parse(ds.textContent || "{}"); data.dateModified = d; ds.textContent = JSON.stringify(data); } catch {} }
        const wp = $("#ld-webpage");
        if (wp) { try { const w = JSON.parse(wp.textContent || "{}"); w.dateModified = d; wp.textContent = JSON.stringify(w); } catch {} }
      }

      function wirePrint() {
        if (!printBtn) return;
        const isEmbedded = (window.top !== window.self);
        printBtn.onclick = () => {
          if (isEmbedded) {
            const url = new URL(location.href);
            url.searchParams.set("print","1");
            url.searchParams.delete("embed");
            window.open(url.toString(), "_blank", "noopener");
          } else {
            window.print();
          }
        };
        const params = new URLSearchParams(location.search);
        if (params.get("print") === "1") setTimeout(() => window.print(), 300);
      }

      async function boot() {
        // Optional embed chromeless mode
        const params = new URLSearchParams(location.search);
        if (params.get("embed") === "1") document.body.classList.add("embed");

        wirePrint();
        wireCommunitySearch();

        try {
          const [payload, upd] = await Promise.allSettled([loadWaukesha(), loadUpdatedAt()]);
          if (payload.status === "fulfilled" && payload.value) {
            buildMonthDropdown(payload.value);
          } else {
            const err = `<div class="kpi"><div class="label">Status</div><div class="value" style="font-size:16px">Couldn’t load live stats</div><div class="delta" style="color:#b91c1c">${payload.reason ? String(payload.reason) : "Unknown error"}</div></div>`;
            if (sfKpis) sfKpis.innerHTML = err;
            if (condoKpis) condoKpis.innerHTML = err;
          }
          if (upd.status === "fulfilled" && upd.value) {
            applyUpdatedAt(upd.value);
          }
        } catch (e) {
          console.error(e);
        }
      }

      document.addEventListener("DOMContentLoaded", boot);
    })();
  </script>
</body>
</html>
