<!doctype html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Waukesha County Housing Market Statistics</title>
  
  <!-- SEO / Social (single source of truth) -->
<link rel="canonical" href="https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats" />
<meta name="robots" content="index,follow" />
<meta name="description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />

<meta property="og:site_name" content="Josh Werner — Realty ONE Group Luminous" />
<meta property="og:locale" content="en_US" />
<meta property="og:title" content="Waukesha County Housing Market Statistics" />
<meta property="og:description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats" />
<meta property="og:image" content="https://waukesha-market-stats.vercel.app/og-image.png" />
<meta property="og:image:alt" content="Waukesha County Market Statistics — Live, auto-updated" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Waukesha County Housing Market Statistics" />
<meta name="twitter:description" content="Live Waukesha County real estate stats updated automatically: median price, closed sales, days on market, and months of supply for single-family and condos." />
<meta name="twitter:image" content="https://waukesha-market-stats.vercel.app/og-image.png" />

<meta name="theme-color" content="#C5A349" />
<meta name="google-site-verification" content="_PjSWN6opbxekpcvJNTYO1gk8nnVpJPm6VE6AYSTbDc" />
<meta name="msvalidate.01" content="51198E56FE8D9E5EE8E0A011FF64E88D" />

  <!-- Screen styles (no print styles here) -->
  <style>
    :root {
      --brand:#C5A349; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f9; --card:#fff;
      --radius:16px; --shadow:0 10px 24px rgba(0,0,0,.08); --shadow-sm:0 3px 10px rgba(0,0,0,.06);
      --maxw:1100px;
    }

    html, body { height:100%; }
    body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; color:var(--ink); background:var(--bg); }

    .container { max-width:var(--maxw); margin-inline:auto; padding:24px; }
    .hero { background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px 18px; }
    .title { margin:0; font-size:clamp(22px,3vw,34px); font-weight:800; }
    .subtitle { margin:4px 0 0 0; color:var(--muted); font-size:14px; }
    .controls { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .pill { display:flex; gap:10px; padding:8px 12px; border-radius:999px; background:#fff; border:1px solid #e5e7eb; box-shadow:var(--shadow-sm); }
    .select, .button { border:1px solid #e5e7eb; background:#fff; border-radius:12px; padding:10px 12px; font-size:14px; }
    .button { cursor:pointer; }

    /* Sticky subnav (screen only) */
    .subnav {
      position:sticky; top:0; z-index:1000;
      display:flex; gap:14px; margin-top:8px; font-size:14px;
      background:var(--card); padding:10px 0; border-top:1px solid #eee; border-bottom:1px solid #eee;
      box-shadow:0 2px 10px rgba(0,0,0,.04);
    }
    .subnav a { color:var(--muted); }
    .subnav a:hover { color:var(--ink); }

    .grid-2 { display:grid; grid-template-columns:1fr; gap:16px; margin-top:16px; }
    @media (min-width:900px) { .grid-2 { grid-template-columns:1fr 1fr; } }

    .card { background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px 18px; }

    .kpis { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px; }
    @media (min-width:720px) { .kpis { grid-template-columns:repeat(3,1fr); } }

    .kpi { border:1px solid #eef0f3; border-radius:14px; padding:12px; background:#fff; }
    .kpi .label { font-size:12px; color:var(--muted); text-transform:uppercase; }
    .kpi .value { font-size:clamp(22px,3vw,28px); font-weight:800; margin-top:6px; }
    .kpi .delta { font-size:12px; margin-top:4px; }
    .up { color:#15803d; } .down { color:#b91c1c; }

    .community-card { display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border:1px solid #eef0f3; border-radius:12px; background:#fff; box-shadow:var(--shadow-sm); }
    .community-grid { display:grid; grid-template-columns:1fr; gap:12px; }
    @media (min-width:680px) { .community-grid { grid-template-columns:repeat(2,1fr); } }
    @media (min-width:980px) { .community-grid { grid-template-columns:repeat(3,1fr); } }

    .search { display:flex; gap:10px; align-items:center; padding:10px 12px; border-radius:12px; background:#fff; border:1px solid #e5e7eb; box-shadow:var(--shadow-sm); }
    .search input { border:none; outline:none; flex:1; font-size:14px; }

    a.link { color:var(--ink); text-decoration:none; border-bottom:1px solid #ddd; }

    .foot { display:flex; align-items:center; justify-content:space-between; gap:12px; color:var(--muted); font-size:12px; margin-top:14px; }

    /* Smooth anchor scroll + offset for sticky nav */
    html { scroll-behavior:smooth; }
    #sf, #condo, #communities { scroll-margin-top:80px; }

    /* Loading skeletons */
    .skel { background: #eef0f3; border-radius: 10px; height: 32px; animation: pulse 1.2s ease-in-out infinite; }
    @keyframes pulse { 0%{opacity:.6} 50%{opacity:1} 100%{opacity:.6} }
    .muted { color: var(--muted); }

    /* Embed mode (hide chrome in iframes) */
    .embed header.container, .embed footer.container { display: none; }
    .embed .container { padding-top: 12px; }

    /* Brand accents */
    :root{ --brand-50:#f8f3e6; --brand-100:#f1e6c9; --brand-200:#e7d5a1; --brand-600:#a8842d; --brand-700:#8f6f25; }

    .cta { margin-top: 16px; background: linear-gradient(180deg, #fff, #fbfaf7); border: 1px solid #e9e5d6; border-radius: 14px; padding: 18px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    .btn, .btn-ghost { display:inline-block; padding:10px 14px; border-radius:10px; font-size:14px; text-decoration:none; border:1px solid var(--brand-200);}
    .btn { background: var(--brand); color:#fff; border-color:var(--brand-600); box-shadow:var(--shadow-sm); }
    .btn-ghost { background:#fff; color:var(--ink); }
    .button{ background:var(--brand); color:#fff; border-color:var(--brand-600); box-shadow:var(--shadow-sm); }
    .pill{ background:var(--brand-50); border-color:var(--brand-200); }
    .badge{ background:var(--brand-50); border:1px solid var(--brand-200); color:var(--brand-700); padding:4px 8px; border-radius:999px; font-size:12px; }

    /* Hide rates in print to keep one page tidy */
    @media print{ #rates{ display:none !important; } }

    /* Rates list styles */
    .rates-list{ display:grid; gap:8px; }
    .rate-row{ display:flex; align-items:center; justify-content:space-between; border:1px solid #eef0f3; border-radius:12px; padding:10px 12px; background:#fff; }
    .rate-row h4{ margin:0; font-size:14px; font-weight:700; }
    .rate-tags{ display:flex; gap:8px; flex-wrap:wrap; margin-top:6px; }
    .tag{ font:12px/1 system-ui; background:var(--brand-50); border:1px solid var(--brand-200); border-radius:999px; padding:2px 8px; }
    .rate-nums{ text-align:right; min-width:160px; }
    .rate-nums .num{ font-weight:800; }
    .rate-nums .sub{ font-size:12px; color:var(--muted); }
  </style>

  <!-- Print styles -->
  <style>
@page { size: Letter portrait; margin: 0.5in; }
@media print {
  html, body { background:#fff !important; color:#111 !important; }
  body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  .container { max-width:none !important; padding:0 !important; }
  header.container, main.container, footer.container { padding:0 !important; }
  .hero { margin: 0 0 0.25in 0 !important; box-shadow:none !important; border:none !important; border-radius:0 !important; }
  .subnav, .search, #printBtn { display:none !important; }
  .grid-2 { grid-template-columns:1fr 1fr !important; gap:0.35in !important; }
  .card { box-shadow:none !important; border:1px solid #e5e7eb !important; border-radius:8px !important; }
  .kpi { break-inside:avoid; }
  .foot { color:#6b7280 !important; }
  .title { font-size:22px !important; }
  .subtitle { font-size:12px !important; }
  .kpi .label { font-size:11px !important; }
  .kpi .value { font-size:20px !important; }
  a.link { color:#111 !important; border-bottom:1px solid #ddd !important; text-decoration:none !important; }
  .container > * { margin-left:0.25in; margin-right:0.25in; }
  .hero, .grid-2, #communities, footer.container { margin-left:0.25in; margin-right:0.25in; }
  #communities { display:none !important; }
}
  </style>

  <!-- Print brand block -->
  <style>
  .print-brand { display:none; }
  @media print {
    .print-brand { display:flex !important; align-items:center; gap:14px; margin:0 0 0.25in 0; padding-bottom:10px; border-bottom:1px solid #e5e7eb; }
    .print-logo { height:56px; max-width:260px; object-fit:contain; }
    .print-contact { font-size:12px; line-height:1.35; }
    .print-contact strong { font-size:14px; }
    .print-contact a { color:#111 !important; text-decoration:none; border-bottom:1px solid #ddd; }
    .print-updated { margin-top:2px; font-size:11px; color:#6b7280; }
  }
  </style>

<script id="ld-dataset" type="application/ld+json">{"@context":"https://schema.org","@type":"Dataset","@id":"https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats#dataset","name":"Waukesha County Housing Market Statistics","description":"Monthly market stats for Waukesha County, WI (Single-Family & Condo): Median Price, Closed Sales, Days on Market, and Months Supply. Auto-updated from RPR.","creator":{"@type":"Person","name":"Josh Werner"},"publisher":{"@type":"Organization","name":"Realty ONE Group Luminous"},"isAccessibleForFree": true,"keywords":["Waukesha County","real estate","market statistics","Wisconsin"],"license":"https://www.narrpr.com/terms/","distribution":[{"@type":"DataDownload","encodingFormat":"application/pdf","contentUrl":"https://www.narrpr.com/reports-v2/c296fac6-035d-4e9a-84fd-28455ab0339f/pdf"},{"@type":"DataDownload","encodingFormat":"application/pdf","contentUrl":"https://www.narrpr.com/reports-v2/5a675486-5c7b-4bb0-9946-0cffa3070f05/pdf"}],"dateModified":"2025-09-16"}</script>

<script id="ld-webpage" type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Waukesha County Housing Market Statistics","url":"https://joshwerner.myrealtyonegroup.com/latest-waukesha-cnty-market-stats","inLanguage":"en-US","description":"Waukesha County housing market statistics updated daily: median price, closed sales, days on market, and months of supply for single-family homes and condos.","isPartOf":{"@type":"WebSite","name":"Josh Werner Real Estate","url":"https://joshwerner.homes"},"primaryImageOfPage":{"@type":"ImageObject","url":"https://waukesha-market-stats.vercel.app/og-image.png"}}</script>

<script id="ld-faq" type="application/ld+json">{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"How often are these stats updated?","acceptedAnswer":{"@type":"Answer","text":"County stats refresh automatically within ~48 hours of RPR updating the underlying PDFs. Community links open live RPR reports that always show the latest version."}},{"@type":"Question","name":"What property types are included?","acceptedAnswer":{"@type":"Answer","text":"We publish snapshots for Single-Family homes and Condos/Townhomes. Each panel shows Median Price, Closed Sales, Days on Market, and Months of Supply."}},{"@type":"Question","name":"Where do these numbers come from?","acceptedAnswer":{"@type":"Answer","text":"Realtors Property Resource® (RPR). The county panels summarize key figures extracted from the Waukesha County RPR PDF; community links point to each city’s live RPR report."}},{"@type":"Question","name":"Can I get a custom city or neighborhood report?","acceptedAnswer":{"@type":"Answer","text":"Yes—contact Josh and we’ll generate a tailored RPR report with recent comps and trends."}}]}</script>

<!-- Keep meta dates in sync with API.updatedAt -->
<meta id="meta-lastmod" name="last-modified" content="2025-09-16" />
<meta id="og-updated" property="og:updated_time" content="2025-09-16T12:00:00Z" />

<script>
  // Sync JSON-LD/meta dates with API.updatedAt (your /api/waukesha, unchanged)
  (async () => {
    try {
      const r = await fetch("/api/waukesha?ts=" + Date.now(), { cache: "no-store" });
      const j = await r.json();
      const d = j?.updatedAt;
      if (!d) return;
      const ds = document.getElementById("ld-dataset");
      if (ds) { const data = JSON.parse(ds.textContent || "{}"); data.dateModified = d; ds.textContent = JSON.stringify(data); }
      const wp = document.getElementById("ld-webpage");
      if (wp) { const w = JSON.parse(wp.textContent || "{}"); w.dateModified = d; wp.textContent = JSON.stringify(w); }
      document.getElementById("meta-lastmod")?.setAttribute("content", d);
      document.getElementById("og-updated")?.setAttribute("content", d + "T12:00:00Z");
    } catch {}
  })();
</script>
</head>
<body>
  <header class="container">
    <!-- Print-only brand header -->
    <div class="print-brand" aria-hidden="true">
      <img class="print-logo" src="/logo.png" alt="Realty ONE Group Luminous — Josh Werner" />
      <div class="print-contact">
        <strong>Josh Werner</strong><br />
        Licensed REALTOR® — Realty ONE Group Luminous<br />
        <a href="tel:+14147597925">(414) 759-7925</a> ·
        <!-- FIXED: closed the mailto tag properly -->
        <a href="mailto:joshwernerrealtor@gmail.com?subject=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!">Email Josh</a> ·
        <a href="https://joshwerner.homes" target="_blank" rel="noopener">joshwerner.homes</a><br />
        WI License #: 93792-94
        <div class="print-updated" id="printUpdated"></div>
      </div>
    </div>

    <!-- Hero -->
    <section class="hero">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h1 class="title">Waukesha County Housing Market Statistics</h1>
          <p class="subtitle">Side by side snapshots for Single-Family and Condos. Updated automatically from RPR.</p>
        </div>
        <div class="controls">
          <span class="pill"><span>Updated</span><strong id="updatedAt">—</strong></span>
          <label class="pill"><span>Month</span><select id="monthSelect" class="select"></select></label>
          <button id="printBtn" class="button" type="button">Print / PDF</button>
        </div>
      </div>
      <nav class="subnav" aria-label="Section navigation">
        <a href="#sf">Single-Family</a>
        <a href="#condo">Condos</a>
        <a href="#communities">Communities</a>
      </nav>
    </section>
  </header>

  <main class="container">
   <!-- RATES: compact rows (section + tiny scoped styles + script) -->
<section id="rates" aria-labelledby="rates-title">
  <style>
    /* Scoped to #rates so we don't fight the rest of your CSS */
    #rates .heading{display:flex;justify-content:space-between;align-items:flex-end;gap:12px}
    #rates .heading h2{margin:0;font-size:22px}
    #rates .controls{color:var(--muted);font-size:14px}
    #rates .rates-list{display:grid;gap:8px;margin-top:10px}
    #rates .rate-row{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border:1px solid #2f3242;border-radius:10px;padding:10px 12px;background:var(--card, #141418)
    }
    #rates .left{min-width:0}
    #rates h4{margin:0;font-size:14px;font-weight:700}
    #rates small{color:var(--muted)}
    #rates .tags{display:flex;gap:6px;flex-wrap:wrap;margin-top:4px}
    #rates .tag{font:12px/1 system-ui;border:1px solid #2f3242;border-radius:999px;padding:2px 8px;color:var(--muted)}
    #rates .nums{text-align:right;min-width:160px}
    #rates .num{font-weight:800;font-size:18px}
    #rates .sub{font-size:12px;color:var(--muted)}
    #rates .skel{height:38px;border-radius:10px;
      background:linear-gradient(90deg,#1b1d26 25%,#202231 37%,#1b1d26 63%);background-size:400% 100%;animation:shimmer 1.2s ease-in-out infinite}
    @keyframes shimmer{0%{background-position:100% 0}100%{background-position:0 0}}
    #rates .updated{margin-top:6px;font-size:12px;color:var(--muted)}
    #rates .disclaimer{margin-top:6px;font-size:12px;line-height:1.35;color:var(--muted)}
  </style>

  <div class="heading">
    <h2 id="rates-title">Local lender rates</h2>
    <div class="controls"><span id="rates-count">0 lenders</span></div>
  </div>

  <div id="rates-list" class="rates-list" aria-live="polite" aria-busy="true">
    <div class="skel"></div>
    <div class="skel"></div>
    <div class="skel"></div>
  </div>

  <div class="updated" id="rates-updated" hidden></div>

  <!-- Disclaimer (muted, compact) -->
  <p class="disclaimer" id="rates-disclaimer">
    Realty ONE Group Luminous does not endorse or recommend any lender listed here. These rates are provided for informational purposes only. Please do your own research and choose your preferred lender.
  </p>
</section>

<script>
  (function () {
    function boot() {
      const list = document.getElementById('rates-list');
      const countEl = document.getElementById('rates-count');
      const updatedEl = document.getElementById('rates-updated');

      // If Google’s renderer or a partial DOM misses these, bail quietly.
      if (!list || !countEl || !updatedEl) return;

      function rowHTML(item){
        const name = item.name || 'Lender';
        const product = item.product || '30 yr fixed';
        const rate = (item.rate != null) ? `${item.rate}%` : '—';
        const apr  = (item.apr  != null) ? `${item.apr}% APR` : '';
        const points = item.points ? `${item.points} pts` : '';
        const meta = [apr, points].filter(Boolean).join(' • ');
        const links = [
          item.url ? `<a class="tag" href="${item.url}" target="_blank" rel="noopener">Rate page</a>` : '',
          item.contactUrl ? `<a class="tag" href="${item.contactUrl}" target="_blank" rel="noopener">Apply</a>` : ''
        ].filter(Boolean).join('');
        return `
          <div class="rate-row">
            <div class="left">
              <h4>${name}</h4>
              <div class="tags">
                <span class="tag">${product}</span>
                ${links}
              </div>
            </div>
            <div class="nums">
              <div class="num">${rate}</div>
              <div class="sub">${meta}</div>
            </div>
          </div>`;
      }

      async function getRates() {
        try {
          const res = await fetch('/api/rates?bust=' + Date.now(), { headers: { 'accept': 'application/json' }, cache: 'no-store' });
          if (!res.ok) throw new Error('Failed to load rates');
          const payload = await res.json();
          const items = Array.isArray(payload?.lenders) ? payload.lenders : [];

          list.setAttribute('aria-busy', 'false');
          list.innerHTML = items.length ? items.map(rowHTML).join('') :
            `<div class="rate-row"><div class="left"><h4>Rates unavailable</h4><small>Please try again shortly.</small></div><div class="nums"><div class="num">—</div></div></div>`;

          countEl.textContent = `${items.length} ${items.length === 1 ? 'lender' : 'lenders'}`;
          updatedEl.hidden = !payload.generatedAt;
          if (!updatedEl.hidden) updatedEl.textContent = `Refreshed ${new Date(payload.generatedAt).toLocaleString()}`;
        } catch (err) {
          list.setAttribute('aria-busy', 'false');
          list.innerHTML = `<div class="rate-row"><div class="left"><h4>Rates unavailable</h4><small>Please try again shortly.</small></div><div class="nums"><div class="num">—</div></div></div>`;
          countEl.textContent = '0 lenders';
          updatedEl.hidden = true;
          // Don’t throw; Googlebot hates drama.
        }
      }

      // First paint + gentle refresh
      getRates();
      setInterval(getRates, 15 * 60 * 1000);
    }

    // If the DOM isn’t ready, wait. If it is, go now.
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', boot, { once: true });
    } else {
      boot();
    }
  })();
</script>

    <!-- Two-up cards -->
    <section class="grid-2">
      <article id="sf" class="card" aria-labelledby="sfTitle">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
          <h2 id="sfTitle" style="margin:0;font-size:20px">Single-Family Homes</h2>
          <span class="badge" id="sfMonth">—</span>
        </div>
        <div class="kpis" id="sfKpis"></div>
        <div class="foot">
          <span id="sfNote"></span>
          <a id="sfReport" class="link" href="https://www.narrpr.com/reports-v2/c296fac6-035d-4e9a-84fd-28455ab0339f/pdf" target="_blank" rel="noopener">Full county report</a>
        </div>
      </article>

      <article id="condo" class="card" aria-labelledby="condoTitle">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
          <h2 id="condoTitle" style="margin:0;font-size:20px">Condos / Townhomes</h2>
          <span class="badge" id="condoMonth">—</span>
        </div>
        <div class="kpis" id="condoKpis"></div>
        <div class="foot">
          <span id="condoNote"></span>
          <a id="condoReport" class="link" href="https://www.narrpr.com/reports-v2/c296fac6-035d-4e9a-84fd-28455ab0339f/pdf" target="_blank" rel="noopener">Full county report</a>
        </div>
      </article>
    </section>

    <!-- Communities -->
    <section id="communities" class="card" style="margin-top:16px">
      <div style="display:flex;align-items:end;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h3 style="margin:0;font-size:18px">Top 10 Communities</h3>
          <p class="subtitle" style="margin:6px 0 0 0">These RPR® reports update automatically every ~48 hours. Click a community to view the live PDF.</p>
        </div>
        <div class="search" role="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="7" stroke="#9ca3af" stroke-width="2"/><path d="M20 20l-3.2-3.2" stroke="#9ca3af" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="searchInput" type="search" placeholder="Search communities…" aria-label="Search communities" />
        </div>
      </div>
      <div id="communityGrid" class="community-grid" style="margin-top:12px"></div>
    </section>

    <!-- FAQs -->
    <section id="faq" class="card" style="margin-top:16px">
      <h2 style="margin:0 0 8px 0; font-size:18px">Market FAQs</h2>
      <details class="faq-item" open><summary>How often are these Waukesha County stats updated?</summary><div class="answer">This page checks for new data every day around 6:00 AM Central (11:00 UTC). Figures refresh shortly after RPR regenerates its county Market Trends reports (typically every ~48 hours). The “Updated” date shows the last successful pull.</div></details>
      <details class="faq-item"><summary>Where do these numbers come from?</summary><div class="answer">Realtors Property Resource® (RPR) county Market Trends PDFs. Links to the full reports are provided on this page.</div></details>
      <details class="faq-item"><summary>Which metrics are shown?</summary><div class="answer">Median Sold Price, Closed Sales, Median Days in RPR (Days on Market), Months of Inventory, and Active Listings (when available).</div></details>
      <details class="faq-item"><summary>Does this include both single-family and condos?</summary><div class="answer">Yes—two side-by-side snapshots. Each links to the corresponding county PDF report for deeper detail.</div></details>
      <details class="faq-item"><summary>Can I print this as a one-page handout?</summary><div class="answer">Yes—use the “Print / PDF” button. The Communities section is hidden on paper to keep the printout to one page.</div></details>
      <details class="faq-item"><summary>How can I get stats for my neighborhood or a custom report?</summary><div class="answer">Use the community links above or contact Josh at (414) 759-7925 or joshwernerrealtor@gmail.com for a custom report.</div></details>
    </section>

    <!-- Related -->
    <section id="related" class="card" style="margin-top:16px">
      <h2 style="margin:0 0 8px 0; font-size:18px">Explore Waukesha Communities</h2>
      <p class="subtitle" style="margin:6px 0 10px 0">Local market guides and homes for sale by city.</p>
      <ul class="related-grid" style="list-style:none; padding:0; margin:0; display:grid; gap:10px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
        <li><a class="link" href="#">Brookfield Market Guide</a></li>
        <li><a class="link" href="#">Menomonee Falls Market Guide</a></li>
        <li><a class="link" href="#">New Berlin Market Guide</a></li>
        <li><a class="link" href="#">Muskego Market Guide</a></li>
        <li><a class="link" href="#">Pewaukee Market Guide</a></li>
        <li><a class="link" href="#">Oconomowoc Market Guide</a></li>
        <li><a class="link" href="#">Hartland Market Guide</a></li>
        <li><a class="link" href="#">Delafield Market Guide</a></li>
        <li><a class="link" href="#">Mukwonago Market Guide</a></li>
        <li><a class="link" href="#">Sussex Market Guide</a></li>
      </ul>
    </section>

    <!-- CTA -->
    <section class="cta" aria-labelledby="ctaTitle">
      <h3 id="ctaTitle">Want a custom city or neighborhood report?</h3>
      <p>I’ll send you a fresh, tailored RPR® report with comps and trends—usually same day.</p>
      <div class="cta-actions">
        <a class="btn" href="mailto:joshwernerrealtor@gmail.com?subject=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!">Email Josh</a>
        <a class="btn outline" href="https://mail.google.com/mail/?view=cm&fs=1&to=joshwernerrealtor@gmail.com&su=Custom%20Market%20Report%20Request&body=Hi%20Josh%2C%0A%0AI%E2%80%99d%20like%20a%20custom%20market%20report%20for%3A%20%5Barea%5D.%0A%0AThanks!" target="_blank" rel="noopener">Use Gmail</a>
        <a class="btn-ghost" href="tel:+14147597925" rel="noopener">Call (414) 759-7925</a>
        <a class="btn-ghost" href="https://joshwerner.homes/?utm_source=market-stats&utm_medium=cta&utm_campaign=waukesha" target="_blank" rel="noopener">Visit Website</a>
      </div>
    </section>
  </main>

  <footer class="container" style="opacity:.9;padding-top:0">
    <p style="font-size:12px;color:var(--muted)">Source: Realtors Property Resource® (RPR). County stats auto-refresh from the county PDF via a secure API.</p>
  </footer>

<!-- MARKET JS (unchanged from your version; uses /api/waukesha) -->
<script>
(() => {
  const ENDPOINT = "/api/waukesha-live";
  const COMMUNITIES = [
    { name: "Brookfield",        url: "https://www.narrpr.com/reports-v2/97a381b7-10f7-40e6-9e36-852d9a194cdf/pdf" },
    { name: "Menomonee Falls",   url: "https://www.narrpr.com/reports-v2/e88b179b-2c39-4b51-9968-f4d8b6df89cb/pdf" },
    { name: "New Berlin",        url: "https://www.narrpr.com/reports-v2/0eedbe20-e01d-4e10-8791-79e0e18f6853/pdf" },
    { name: "Muskego",           url: "https://www.narrpr.com/reports-v2/adda4cc2-f31f-4549-a499-793c061484b8/pdf" },
    { name: "Pewaukee",          url: "https://www.narrpr.com/reports-v2/d62c13ba-f21d-44d4-b4f1-cb89d62cfd1d/pdf" },
    { name: "Oconomowoc",        url: "https://www.narrpr.com/reports-v2/2635ef10-f399-4498-987f-34784fca249a/pdf" },
    { name: "Hartland",          url: "https://www.narrpr.com/reports-v2/579c97c4-b4d9-4eb4-980e-890348286b9b/pdf" },
    { name: "Delafield",         url: "https://www.narrpr.com/reports-v2/cfaf9afb-4e22-44b9-b114-0d64b1be0639/pdf" },
    { name: "Mukwonago",         url: "https://www.narrpr.com/reports-v2/17d2ea0c-a2d7-4dce-954c-e2140ac59f88/pdf" },
    { name: "Sussex",            url: "https://www.narrpr.com/reports-v2/41f387a4-b092-42c4-b23a-b3575ae52116/pdf" }
  ];

  const params = new URLSearchParams(location.search);
  const isEmbedded = (window.top !== window.self);
  const shouldAutoPrint = params.get('print') === '1';
  const $=(q,el=document)=>el.querySelector(q);

  const updatedAtEl=$("#updatedAt"), monthSelect=$("#monthSelect");
  const sfMonthEl=$("#sfMonth"), condoMonthEl=$("#condoMonth");
  const sfKpis=$("#sfKpis"), condoKpis=$("#condoKpis");
  const sfReport=$("#sfReport"), condoReport=$("#condoReport");
  const searchInput=$("#searchInput"), communityGrid=$("#communityGrid");

  const fCurrency=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(v);
  const fNumber=v=>new Intl.NumberFormat("en-US").format(v);
  const fNumber1=v=>new Intl.NumberFormat("en-US",{maximumFractionDigits:1}).format(v);

  function kpiEl(label, value, prev, type){
    const el = document.createElement("div");
    el.className = "kpi";
    const hasValue = typeof value === "number" && !Number.isNaN(value);
    const hasPrev  = typeof prev  === "number" && !Number.isNaN(prev);
    let formatted = "—";
    if (hasValue) {
      formatted = type === "currency" ? fCurrency(value)
                : type === "number1" ? fNumber1(value)
                : fNumber(value);
    }
    let deltaBlock = "";
    if (hasValue && hasPrev) {
      const diff = value - prev;
      const dir  = diff === 0 ? 0 : (diff > 0 ? 1 : -1);
      const pct  = prev === 0 ? 0 : (diff / prev) * 100;
      const arrow = dir === 0 ? "—" : (dir > 0 ? "▲" : "▼");
      const cls   = dir === 0 ? "" : (dir > 0 ? "up" : "down");
      deltaBlock = `<div class="delta ${cls}">${arrow} ${Math.abs(pct).toFixed(1)}% MoM</div>`;
    }
    el.innerHTML = `<div class="label">${label}</div><div class="value">${formatted}</div>${deltaBlock}`;
    return el;
  }

  function paintMonth(key, dataObj){
  const months = Object.keys(dataObj.months).sort();
  const idx = months.indexOf(key);
  const cur = dataObj.months[key];
  const prev = dataObj.months[months[idx-1]];
  const [y,m] = key.split("-");
  const label = new Date(+y, +m-1, 1).toLocaleDateString(undefined,{month:"long",year:"numeric"});

  const sfMonthEl = document.getElementById("sfMonth");
  const condoMonthEl = document.getElementById("condoMonth");
  const sfKpis = document.getElementById("sfKpis");
  const condoKpis = document.getElementById("condoKpis");

  if (sfMonthEl) sfMonthEl.textContent = label;
  if (condoMonthEl) condoMonthEl.textContent = label;
  if (sfKpis) sfKpis.innerHTML = "";
  if (condoKpis) condoKpis.innerHTML = "";

  const METRICS = [
    { key:"medianPrice",    label:"Median Price",    type:"currency" },
    { key:"closed",         label:"Closed Sales",    type:"number"   },
    { key:"dom",            label:"Days on Market",  type:"number"   },
    { key:"monthsSupply",   label:"Months Supply",   type:"number1"  },
    { key:"activeListings", label:"Active Listings", type:"number"   }
  ];

  const safe = (o,k) => (o && o[k] != null ? o[k] : undefined);

  METRICS.forEach(m=>{
    if (sfKpis) sfKpis.appendChild(kpiEl(m.label, safe(cur?.sf, m.key),    safe(prev?.sf, m.key),    m.type));
    if (condoKpis) condoKpis.appendChild(kpiEl(m.label, safe(cur?.condo, m.key), safe(prev?.condo, m.key), m.type));
  });
}

  function renderCommunities(list){
    const grid = communityGrid; if (!grid) return;
    grid.innerHTML="";
    list.forEach(c=>{
      const a=document.createElement("a");
      a.className="community-card"; a.href=c.url; a.target="_blank"; a.rel="noopener";
      a.innerHTML=`<span>${c.name}</span><span style="color:#9ca3af">PDF →</span>`;
      grid.appendChild(a);
    });
  }

  function render(payload){
    if (updatedAtEl && payload.updatedAt) {
      updatedAtEl.textContent = new Date(payload.updatedAt + "T12:00:00Z").toLocaleDateString();
    }
    const months=Object.keys(payload.months).sort().reverse();
    if (monthSelect) {
      monthSelect.innerHTML="";
      months.forEach(k=>{
        const [y,m]=k.split("-"); const dt=new Date(+y,+m-1,1);
        const opt=document.createElement("option");
        opt.value=k; opt.textContent=dt.toLocaleDateString(undefined,{month:"long",year:"numeric"});
        monthSelect.appendChild(opt);
      });
      monthSelect.value=months[0];
      monthSelect.onchange=e=>paintMonth(e.target.value, payload);
    }
    paintMonth(months[0], payload);
    if (sfReport && payload.months[months[0]]?.sfReport) sfReport.href = payload.months[months[0]].sfReport;
    if (condoReport && payload.months[months[0]]?.condoReport) condoReport.href = payload.months[months[0]].condoReport;
    renderCommunities(COMMUNITIES);
    const pu = document.getElementById("printUpdated");
    if (pu && payload?.updatedAt) pu.textContent = "Updated " + new Date(payload.updatedAt).toLocaleDateString();
    const btn = document.getElementById("printBtn");
    if (btn) btn.onclick = () => (window.top !== window.self) ? window.open(new URL(location.href + (location.search ? "&" : "?") + "print=1"), "_blank", "noopener") : window.print();
    const params = new URLSearchParams(location.search);
    if (params.get('print') === '1') setTimeout(() => window.print(), 300);
  }

  async function boot(){
    try{
      const params = new URLSearchParams(location.search);
      if (params.get('embed') === '1') document.body.classList.add('embed');
      const r = await fetch(ENDPOINT + "?ts=" + Date.now(), { cache: "no-store" });
      if(!r.ok) throw new Error(`API ${r.status} ${r.statusText}`);
      const json=await r.json();
      render(json);
    }catch(e){
      console.error(e);
      const err = `<div class="kpi"><div class="label">Status</div><div class="value" style="font-size:16px">Couldn’t load live stats</div><div class="delta" style="color:#b91c1c">${(e && e.message) ? e.message : String(e)}</div></div>`;
      const sfKpis=document.getElementById("sfKpis");
      const condoKpis=document.getElementById("condoKpis");
      if (sfKpis) sfKpis.innerHTML = err;
      if (condoKpis) condoKpis.innerHTML = err;
    }
  }

  document.addEventListener("DOMContentLoaded", boot);
})();
</script>

<!-- RATES SCRIPT: renders from /api/rates; shows APR if base rate missing -->
<script>
(() => {
  const bodyEl   = document.getElementById("ratesBody");
  const stampEl  = document.getElementById("ratesUpdated");

  function row(l) {
    const primary = l?.rate || l?.apr;   // prefer base rate, else APR
    const label   = l?.rate ? "" : " APR";
    const aprTxt  = l?.apr  ? `${l.apr}% APR` : "";
    const ptsTxt  = l?.points ? `${l.points} pts` : "";
    const sub     = [aprTxt, ptsTxt].filter(Boolean).join(" • ");

    const div = document.createElement("div");
    div.className = "rate-row";
    div.innerHTML = `
      <div>
        <h4>${l?.name || "Lender"}</h4>
        <div class="rate-tags">
          <span class="tag">${l?.product || "30 yr fixed"}</span>
          ${l?.url ? `<a class="tag" href="${l.url}" target="_blank" rel="noopener">Rate page</a>` : ""}
          ${l?.contactUrl ? `<a class="tag" href="${l.contactUrl}" target="_blank" rel="noopener">Get pre-approved</a>` : ""}
        </div>
      </div>
      <div class="rate-nums">
        <div class="num" style="font-size:18px">${primary ? `${primary}%${label}` : "—"}</div>
        <div class="sub">${sub}</div>
      </div>
    `;
    return div;
  }

  async function loadRates(){
    try {
      stampEl.textContent = "Loading…";
      const r = await fetch("/api/rates", { headers: { accept: "application/json" } });
      if (!r.ok) throw new Error(`HTTP ${r.status}`);
      const j = await r.json();
      const lenders = Array.isArray(j.lenders) ? j.lenders : [];
      const hasNumbers = lenders.some(x => x && (x.rate || x.apr));
      bodyEl.innerHTML = "";
      (hasNumbers ? lenders : (j.sample || [])).forEach(l => bodyEl.appendChild(row(l)));
      const ts = j.generatedAt || lenders[0]?.updatedAt;
      stampEl.textContent = ts
        ? `Updated ${new Date(ts).toLocaleDateString()} ${new Date(ts).toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}`
        : "Updated recently";
    } catch (e) {
      bodyEl.innerHTML = `
        <div class="rate-row">
          <div><h4>Rates unavailable</h4><small class="muted">Could not load lender data.</small></div>
          <div class="rate-nums"><div class="num">—</div><div class="sub">Try again soon</div></div>
        </div>`;
      stampEl.textContent = "Error";
      console.error(e);
    }
  }

  loadRates();
  setInterval(loadRates, 15 * 60 * 1000);
})();
</script>
</body>
</html>
